---
title: "Participation & global conflict"
format: html
editor: visual
---

```{R}
install.packages("tidytuesdayR")

tuesdata <- tidytuesdayR::tt_load('2021-07-27')
tuesdata <- tidytuesdayR::tt_load(2021, week = 31)

olympics <- tuesdata$olympics

olympics <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-07-27/olympics.csv')
```
## Data wrangling analysis 1 - AC
```{r}
#So the winter and summer were held in the same year up until 1992.
#We are going to look at the data from 1896 - 1992. first we filter
library(dplyr)
library(ggplot2)
library(anytime)
subolympics <- olympics %>% filter(year < 1992)
# create data set that sums the countries by year. Starting in the 1800s is too much
countries <- subolympics %>%
  group_by(noc,year) %>%
  summarise(participantnum = n(), .groups = "drop")

```

## Data wrangling analysis 2 - AC
```{r}
1 + 1
```



#Analysis
## Analysis 1 - AC: How does global conflict influence the number of nations who participate in the Olympics?
```{r fig.align="center", echo=FALSE, fig.width=14}
#split the data into two frames summer and winter
ggplot(countries, aes(x=year, y=participantnum, fill = noc)) +
  geom_col() +
  scale_x_continuous(n.breaks = 49) +
  scale_y_continuous(n.breaks = 50) +
  theme(axis.text.x = element_text(angle=90, vjust = 0.5, hjust = 1))+
  theme(legend.position = "none") +
  labs(title = "Number of participants in olympics per year", x="Year of olympic games", y= "Total number of participants")+
  theme(plot.title = element_text(size = 16, face= "bold", hjust = 0.5))
  


```

## Analysis 2 - AC: How does body weight make a difference in the ability of an athlete to medal in a sport?
```{r}
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
runtime: shiny
```

```{r setup, include=FALSE}
library(flexdashboard)
```

Column {data-width=1000}
-----------------------------------------------------------------------

### Part 1

```{r}
library(dplyr)
library(tibble)
library(shiny)
library(purrr)
library(DT)
library(shinydashboard)
library(rsconnect)
library(ggplot2)



# Define UI for application that draws a histogram
ui <- fluidPage(

    # Application title
    titlePanel("Cocktail Data"),

    # Sidebar with a slider input for number of bins 
    sidebarLayout(
        sidebarPanel(
            sliderInput("bins",
                        "Number of bins:",
                        min = 1,
                        max = 100,
                        value = 30)
        ),

        # Show a plot of the generated distribution
        mainPanel(tabPanel("plots",
           plotOutput("distPlot"),
           tableOutput("drop down")
        )
    )
)
)

# Define server logic required to draw a histogram
server <- function(input, output) {

    output$distPlot <- renderPlot({
        # generate bins based on input$bins from ui.R
        x    <- glassnum$n
        bins <- seq(min(x), max(x), length.out = input$bins + 1)

        # draw the histogram with the specified number of bins
        hist(x, breaks = bins, col = 'darkgray', border = 'white',
             xlab = 'Number of times a glass was used in a cocktail',
             main = 'Histogram of number of times a glass was used')
    })
}

shinyApp(ui, server)
```
```{r}
newlook <- cocktails %>% 
  group_by(ingredient) %>% 
  summarise(drinks = list(drink))

ui <- fluidRow(
  titlePanel("What Are You Making This Week?"),
  fluidRow(column(2,
                  selectInput("ingr",
                              "ingredient:",
                              c("all", 
                                unique(as.character(newlook$ingredient)))))
                  ),

DT::dataTableOutput("table")
)

server <-function(input, output) {
  
  # Filter data based on selections
  output$table <- DT::renderDataTable(DT::datatable({
    data <- newlook
    if (input$ingr != "All") {
      data <- data[data$ingredient == input$ingr,]
    }
    data
  }))
}


shinyApp(ui, server)
```

## Analysis 3 -SG
```{r}
1 + 1
```

## Analysis 4 - SG
```{r}
1 + 1
```

#Conclusions
